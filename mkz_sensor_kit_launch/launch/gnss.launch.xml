<launch>
  <!-- This file WILL launch the NovAtel Oem7 driver -->
  <arg name="launch_driver" default="true"/>

  <!-- === NovAtel driver args (defaults point to your $HOME/novatel workspace) === -->
  <arg name="novatel_config_file"
       default="$(env HOME)/novatel/src/novatel_oem7_driver/src/novatel_oem7_driver/config/receiver.yaml"/>
  <arg name="novatel_init_file"
       default="$(env HOME)/novatel/src/novatel_oem7_driver/src/novatel_oem7_driver/config/std_init_commands.yaml"/>
  <arg name="oem7_ip_addr" default="192.168.4.199"/>

  <!-- Topics coming from your NovAtel driver -->
  <arg name="navsatfix_topic_name"   default="/novatel/oem7/fix"/>
  <arg name="orientation_topic_name" default="/novatel/oem7/inspva"/>

  <!-- Frame used by gnss_poser -->
  <arg name="gnss_frame" default="gnss_link"/>

  <!-- ===== Launch the NovAtel Oem7 driver (from installed package) ===== -->
  <group if="$(var launch_driver)">
    <include file="$(find-pkg-share novatel_oem7_driver)/launch/oem7_net.launch.py">
      <arg name="config_file" value="$(var novatel_config_file)"/>
      <arg name="init_commands_file" value="$(var novatel_init_file)"/>
      <arg name="oem7_ip_addr" value="$(var oem7_ip_addr)"/>
    </include>
  </group>

  <!-- ===== Autoware GNSS namespace & gnss_poser ===== -->
  <group>
    <push-ros-namespace namespace="gnss"/>

    <!-- NavSatFix (+ orientation) -> /sensing/gnss/{pose,pose_with_covariance,fixed} -->
    <include file="$(find-pkg-share autoware_gnss_poser)/launch/gnss_poser.launch.xml">
      <arg name="input_topic_fix" value="$(var navsatfix_topic_name)"/>
      <arg name="input_topic_orientation" value="$(var orientation_topic_name)"/>

      <arg name="output_topic_gnss_pose" value="pose"/>
      <arg name="output_topic_gnss_pose_cov" value="pose_with_covariance"/>
      <arg name="output_topic_gnss_fixed" value="fixed"/>

      <arg name="use_gnss_ins_orientation" value="true"/>
      <arg name="gnss_frame" value="$(var gnss_frame)"/>
    </include>
  </group>
</launch>

